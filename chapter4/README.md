# 4章 プロセススケジューラ

Linuxカーネルはプロセスを同時に実行しているように見せかけることを普段行っている。これは1つのCPU上で1つのプロセスしか動かせないためである。
クアッドコアやデュアルコアといったマルチコアCPUは1つのコアを1つのPCUと認識させることで複数プロセスを実行することを可能としている。

# sched.c
・論理CPU上で複数プロセスを動かしそれらの進捗を確認することを行う
・loops_per_msec()によって1秒あたりの計算量を見積もっている。
・1core-n process.txt(n=1,2,4)についてx軸を経過時間(ms),y軸をプロセス番号(2つ目)とすると、そのタイミングでどのプロセスが動作しているかを確認できる。
・1core-n process.txt(n=1,2,4)についてx軸を経過時間(ms),y軸をプロセスの進捗(3つ目)とすると、そのタイミングでそのプロセスが任意の時間にどれだけの進捗であるかが確認できる。

## コンテキストスイッチ
論理CPU上で実行するプロセスを切り替えることをいう。タイムスライスによって次のプロセスに移る際に発生する。

# プロセスの状態遷移
プロセスは生成されてから「実行待ち状態」となる。そして、「実行待ち状態」のプロセスはCPU実行権を得た時に「実行状態」となる。実行中のプロセスはCPU実行権を失い「実行待ち状態」となるかイベント待ちのために「スリープ状態」となる。このように実行中は実行待ち状態、実行状態、スリープ状態を行き来する。
実行し終わったプロセスは、ゾンビ状態となって終了となる。

## sched.cにおける状態遷移
・プロセスが1つの場合
基本的には実行中のプロセスp0が実行中であるため論理CPUを専有する。

プロセスが1つの場合でも実行途中でスリープ状態となる場合には、スリープ状態のときのみ論理CPUを専有しない。このとき論理CPUはアイドルプロセスという何もしないプロセスを動作している。

・プロセスが2つの場合
実行状態のp0と実行可能状態のp1が最初に存在しており、これらがタイムスライスごとに状態が入れ替わる。
